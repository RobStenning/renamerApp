<!DOCTYPE html>
<html lang="en">
<head>
    <title>RENAMER</title>
    <link href="./main.css" rel="stylesheet">

</head>
<body>
    <div>
        <h1>RENAMER</h1>
        <br>
        <div>Select the project code
            <form class="basic" id="setCode">Current project code: <a id="code">XXXXX</a>
                <br>
                <input type="text" id="projectcode" placeholder="XXXXX">
                <button type="submit" id="submitprojectcode">SET</button>
            </form>
        </div>
        <br>
        <div>Select the txt file location</div>
        <div>Current file: 
            <a class="basic" id="currentFile">none</a>
        </div>
        <button type="file" id="txtFileLocation" accept=".txt">Choose File</button>
        <p></p>
        <div>Select the PDF folder location</div>
        <div>Current file: 
            <a class="basic" id="currentFolder">none</a>
        </div>
        <button type="directory" id="pdfFolderLocation">Choose Folder</button>
        <p></p>
        <form id="rename">
            <button type="submit">RENAME</button>
        </form>
        <br>
        <div class="complete" id="success"></div>
    </div>
<script>
    const ipc = require('electron').ipcRenderer;

//project code button
const submitCodeSet = document.getElementById('submitprojectcode');
const setCode = document.getElementById('projectcode');

submitCodeSet.addEventListener('click', function (event, data) {
        event.preventDefault();
        data = document.getElementById('code').innerHTML = setCode.value;
        if (data !== '') {
            document.getElementById('code').className = 'complete';
            projectCodeSet = true;
        } else {
            document.getElementById('code').innerHTML = 'set the project code'
            document.getElementById('code').className = 'alert';
            projectCodeSet = false;
        }
        ipc.send('projectcode-set', data);
});

//choose file button
const txtButton = document.getElementById('txtFileLocation');
    txtButton.addEventListener('click', function (event) {
        ipc.send('open-file-dialog-for-file');
});

    ipc.on('selected-file', function (event, path) {
    console.log('Full path: ', path);
    document.getElementById('currentFile').innerHTML = path;
    ipc.send('file-url', path);
    document.getElementById('currentFile').className = 'complete';
    txtFileSet = true;
});

//choose folder button
    const folderButton = document.getElementById('pdfFolderLocation');
    folderButton.addEventListener('click', function (event) {
        ipc.send('open-folder-dialog-for-folder');
    });

    ipc.on('selected-folder', function (event, folderPath) {
    console.log('Full path: ', folderPath);
    document.getElementById('currentFolder').innerHTML = folderPath;
    ipc.send('folder-url', folderPath);
    document.getElementById('currentFolder').className = 'complete';
    folderLocationSet = true;
});
    //RENAME button
    function message(event){
        event.preventDefault();
        if (projectCodeSet === false
        ||
        txtFileSet === false
        ||
        folderLocationSet === false
        ) {
            selectionCheck()
        } else {
        ipc.send('rename');
        document.getElementById('success').innerHTML = 'RENAMED!'
}};

    const renameSubmit = document.querySelector('#rename');
    renameSubmit.addEventListener('submit', message);

    //css logic
    let projectCodeSet = false;
    let txtFileSet = false;
    let folderLocationSet = false;

    function selectionCheck(){
        switch(projectCodeSet || txtFileSet || folderLocationSet === false){
            case projectCodeSet === false:
                document.getElementById('code').innerHTML = 'set the project code'
                document.getElementById('code').className = 'alert';
                document.getElementById('success').innerHTML = ''
                console.log(`project code = ${projectCodeSet}`);
            break;        
            case txtFileSet === false:
                document.getElementById('currentFile').className = 'alert';
                document.getElementById('success').innerHTML = ''
                console.log(`file location = ${txtFileSet}`);
            break;
            case folderLocationSet === false:
                document.getElementById('currentFolder').className = 'alert';
                document.getElementById('success').innerHTML = ''
                console.log(`folder location = ${folderLocationSet}`);
            break;
            default:
            document.getElementById('code').className = 'alert';
            document.getElementById('currentFile').className = 'alert';
        }
    }; 
    

</script>

</body>
</html>